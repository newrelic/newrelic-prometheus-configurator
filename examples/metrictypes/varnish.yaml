config:
  newrelic_remote_write:
    extra_write_relabel_configs:
      - source_labels: [__name__]
        regex: 'varnish_lck_dbg_busy|varnish_lck_dbg_try_fail|varnish_lock_created|varnish_lock_destroyed|varnish_lock_operations|varnish_main_backend_busy|varnish_main_backend_conn|varnish_main_backend_fail|varnish_main_backend_recycle|varnish_main_backend_req|varnish_main_backend_retry|varnish_main_backend_reuse|varnish_main_backend_unhealthy|varnish_main_bans_added|varnish_main_bans_deleted|varnish_main_bans_dups|varnish_main_bans_lurker_contention|varnish_main_bans_lurker_obj_killed|varnish_main_bans_lurker_obj_killed_cutoff|varnish_main_bans_lurker_tested|varnish_main_bans_lurker_tests_tested|varnish_main_bans_obj_killed|varnish_main_bans_tested|varnish_main_bans_tests_tested|varnish_main_beresp_shortlived|varnish_main_beresp_uncacheable|varnish_main_bgfetch_no_thread|varnish_main_busy_killed|varnish_main_busy_sleep|varnish_main_busy_wakeup|varnish_main_cache_hit|varnish_main_cache_hit_grace|varnish_main_cache_hitmiss|varnish_main_cache_hitpass|varnish_main_cache_miss|varnish_main_client_req|varnish_main_client_req_400|varnish_main_client_req_417|varnish_main_client_resp_500|varnish_main_esi_errors|varnish_main_esi_req|varnish_main_esi_warnings|varnish_main_exp_mailed|varnish_main_exp_received|varnish_main_fetch|varnish_main_fetch_total|varnish_main_hcb_insert|varnish_main_hcb_lock|varnish_main_hcb_nolock|varnish_main_losthdr|varnish_main_n_expired|varnish_main_n_gunzip|varnish_main_n_gzip|varnish_main_n_lru_limited|varnish_main_n_lru_moved|varnish_main_n_lru_nuked|varnish_main_n_obj_purged|varnish_main_n_purges|varnish_main_n_test_gunzip|varnish_main_pipe_limited|varnish_main_req_dropped|varnish_main_s_bgfetch|varnish_main_s_pass|varnish_main_s_pipe|varnish_main_s_pipe_hdrbytes|varnish_main_s_pipe_in|varnish_main_s_pipe_out|varnish_main_s_req_bodybytes|varnish_main_s_req_hdrbytes|varnish_main_s_resp_bodybytes|varnish_main_s_resp_hdrbytes|varnish_main_s_synth|varnish_main_sc_overload|varnish_main_sc_pipe_overflow|varnish_main_sc_range_short|varnish_main_sc_rem_close|varnish_main_sc_req_close|varnish_main_sc_req_http10|varnish_main_sc_req_http20|varnish_main_sc_resp_close|varnish_main_sc_rx_bad|varnish_main_sc_rx_body|varnish_main_sc_rx_close_idle|varnish_main_sc_rx_junk|varnish_main_sc_rx_overflow|varnish_main_sc_rx_timeout|varnish_main_sc_tx_eof|varnish_main_sc_tx_error|varnish_main_sc_tx_pipe|varnish_main_sc_vcl_failure|varnish_main_sessions|varnish_main_sessions_total|varnish_main_shm_bytes|varnish_main_shm_cont|varnish_main_shm_cycles|varnish_main_shm_flushes|varnish_main_shm_records|varnish_main_shm_writes|varnish_main_summs|varnish_main_threads_created|varnish_main_threads_destroyed|varnish_main_threads_failed|varnish_main_threads_limited|varnish_main_uptime|varnish_main_vcl_fail|varnish_main_ws_backend_overflow|varnish_main_ws_client_overflow|varnish_main_ws_session_overflow|varnish_main_ws_thread_overflow|varnish_mempool_allocs|varnish_mempool_frees|varnish_mempool_randry|varnish_mempool_recycle|varnish_mempool_surplus|varnish_mempool_timeout|varnish_mempool_toosmall|varnish_mgt_child_died|varnish_mgt_child_dump|varnish_mgt_child_exit|varnish_mgt_child_panic|varnish_mgt_child_start|varnish_mgt_child_stop|varnish_mgt_uptime|varnish_sma_c_bytes|varnish_sma_c_fail|varnish_sma_c_freed|varnish_sma_c_req'
        target_label: newrelic_metric_type
        replacement: "counter"
        action: replace
